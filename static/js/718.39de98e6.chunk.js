(self.webpackChunk_3d_examples=self.webpackChunk_3d_examples||[]).push([[718],{5718:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return D}});var n=r(4165),i=r(5861),o=r(9611),a=r(8814);function s(t,e,r){return s=(0,a.Z)()?Reflect.construct.bind():function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&(0,o.Z)(i,r.prototype),i},s.apply(null,arguments)}var l=r(2982),u=r(5671),c=r(3144),h=r(136),d=r(9388),f=r(7313),v=r(3562),m=r(2518),p=r(6892),g=r(4849),b=r(40),y=r(6938),_=r(1935),w=r(3500),T=r(5349);function x(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(x.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),x.FullScreenQuad=function(){var t=new v.iKG(-1,1,1,-1,0,1),e=new v._12(2,2),r=function(t){this._mesh=new v.Kj0(e,t)};return Object.defineProperty(r.prototype,"material",{get:function(){return this._mesh.material},set:function(t){this._mesh.material=t}}),Object.assign(r.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(e){e.render(this._mesh,t)}}),r}();var M=function(t,e,r,n){x.call(this),this.strength=void 0!==e?e:1,this.radius=r,this.threshold=n,this.resolution=void 0!==t?new v.FM8(t.x,t.y):new v.FM8(256,256),this.clearColor=new v.Ilk(0,0,0);var i={minFilter:v.wem,magFilter:v.wem,format:v.wk1};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;var o=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);this.renderTargetBright=new v.dd2(o,a,i),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var s=0;s<this.nMips;s++){var l=new v.dd2(o,a,i);l.texture.name="UnrealBloomPass.h"+s,l.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(l);var u=new v.dd2(o,a,i);u.texture.name="UnrealBloomPass.v"+s,u.texture.generateMipmaps=!1,this.renderTargetsVertical.push(u),o=Math.round(o/2),a=Math.round(a/2)}void 0===T.Y&&console.error("UnrealBloomPass relies on LuminosityHighPassShader");var c=T.Y;this.highPassUniforms=v.rDY.clone(c.uniforms),this.highPassUniforms.luminosityThreshold.value=n,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new v.jyz({uniforms:this.highPassUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var h=[3,5,7,9,11];for(o=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2),s=0;s<this.nMips;s++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(h[s])),this.separableBlurMaterials[s].uniforms.texSize.value=new v.FM8(o,a),o=Math.round(o/2),a=Math.round(a/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=e,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new v.Pa4(1,1,1),new v.Pa4(1,1,1),new v.Pa4(1,1,1),new v.Pa4(1,1,1),new v.Pa4(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===w.C&&console.error("UnrealBloomPass relies on CopyShader");var d=w.C;this.copyUniforms=v.rDY.clone(d.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new v.jyz({uniforms:this.copyUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:v.WMw,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new v.Ilk,this.oldClearAlpha=1,this.basic=new v.vBJ,this.fsQuad=new x.FullScreenQuad(null)};M.prototype=Object.assign(Object.create(x.prototype),{constructor:M,dispose:function(){for(var t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose()},setSize:function(t,e){var r=Math.round(t/2),n=Math.round(e/2);this.renderTargetBright.setSize(r,n);for(var i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(r,n),this.renderTargetsVertical[i].setSize(r,n),this.separableBlurMaterials[i].uniforms.texSize.value=new v.FM8(r,n),r=Math.round(r/2),n=Math.round(n/2)},render:function(t,e,r,n,i){this.oldClearColor.copy(t.getClearColor(new v.Ilk(0))),this.oldClearAlpha=t.getClearAlpha();var o=t.autoClear;t.autoClear=!1,t.setClearColor(this.clearColor,0),i&&t.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=r.texture,t.setRenderTarget(null),t.clear(),this.fsQuad.render(t)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,t.setRenderTarget(this.renderTargetBright),t.clear(),this.fsQuad.render(t);for(var a=this.renderTargetBright,s=0;s<this.nMips;s++)this.fsQuad.material=this.separableBlurMaterials[s],this.separableBlurMaterials[s].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[s].uniforms.direction.value=M.BlurDirectionX,t.setRenderTarget(this.renderTargetsHorizontal[s]),t.clear(),this.fsQuad.render(t),this.separableBlurMaterials[s].uniforms.colorTexture.value=this.renderTargetsHorizontal[s].texture,this.separableBlurMaterials[s].uniforms.direction.value=M.BlurDirectionY,t.setRenderTarget(this.renderTargetsVertical[s]),t.clear(),this.fsQuad.render(t),a=this.renderTargetsVertical[s];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.setRenderTarget(this.renderTargetsHorizontal[0]),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,i&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(r),this.fsQuad.render(t)),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=o},getSeperableBlurMaterial:function(t){return new v.jyz({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new v.FM8(.5,.5)},direction:{value:new v.FM8(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tfloat alphaSum = 0.0;\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\t\t\t\t\t\tdiffuseSum += (sample1.rgb + sample2.rgb) * w;\t\t\t\t\t\talphaSum += (sample1.a + sample2.a) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, alphaSum/weightSum);\n\t\t\t\t}"})},getCompositeMaterial:function(t){return new v.jyz({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),M.BlurDirectionX=new v.FM8(1,0),M.BlurDirectionY=new v.FM8(0,1);var C=r(377),S=r.n(C),P=r(5902),k=r.n(P),U=r(6417);console.log(M);var D=function(t){(0,h.Z)(o,t);var e=(0,d.Z)(o);function o(){var t;(0,u.Z)(this,o);for(var a=arguments.length,c=new Array(a),h=0;h<a;h++)c[h]=arguments[h];return(t=e.call.apply(e,[this].concat(c))).state={loadingProcess:0,sceneReady:!1},t.initThree=function(){var t={width:window.innerWidth,height:window.innerHeight},e=new v.CP7({canvas:document.querySelector("canvas.webgl"),antialias:!0,alpha:!0});e.setPixelRatio(Math.min(window.devicePixelRatio,2)),e.setSize(t.width,t.height),e.autoClear=!1,e.setClearAlpha(0),e.physicallyCorrectLights=!0,e.toneMapping=v.YGz,e.toneMappingExposure=2;var o=new v.xsS,a=new v.cPb(75,t.width/t.height,.1,1e4);a.position.set(0,1,5);var u=new m.z(a,e.domElement);u.enableDamping=!0,u.enablePan=!1,u.minPolarAngle=.5,u.maxPolarAngle=2.5,u.minAzimuthAngle=-1,u.maxAzimuthAngle=1,window.addEventListener("resize",(function(){t.width=window.innerWidth,t.height=window.innerHeight,e.setSize(t.width,t.height),e.setPixelRatio(Math.min(window.devicePixelRatio,2)),a.aspect=t.width/t.height,a.updateProjectionMatrix()}));var c=new v.Mig(16777215,1.2);o.add(c);var h=new v.Ox3("#ffffff",4);h.castShadow=!0,h.shadow.camera.far=15,h.shadow.mapSize.set(1024,1024),h.shadow.normalBias=.05,h.position.set(.25,3,-1.25),o.add(h);var d=2.39,f=0,w=.38,T=[1,5,1],x=[2,20,2],C=[44,97,15],P=[14,28,5],U=[255,255,255],D=[74,145,0],I=new v.dpR,A=new v.BKK(8,8,1,1),F=new v.jyz({uniforms:{time:{type:"f",value:0},perlinnoise:{type:"t",value:I.load(r(9340))},sparknoise:{type:"t",value:I.load(r(8941))},waterturbulence:{type:"t",value:I.load(r(6316))},noiseTex:{type:"t",value:I.load(r(4543))},color5:{value:s(v.Pa4,(0,l.Z)(D))},color4:{value:s(v.Pa4,(0,l.Z)(U))},color3:{value:s(v.Pa4,(0,l.Z)(P))},color2:{value:s(v.Pa4,(0,l.Z)(C))},color1:{value:s(v.Pa4,(0,l.Z)(x))},color0:{value:s(v.Pa4,(0,l.Z)(T))},resolution:{value:new v.FM8(t.width,t.height)}},fragmentShader:k(),vertexShader:S()}),E=new v.Kj0(A,F);E.layers.set(1),o.add(E);var R=new y.C(o,a),O=new M(new v.FM8(window.innerWidth,window.innerHeight),1.5,.4,.85);O.threshold=f,O.strength=d,O.radius=w;var B=new _.xC(e);B.renderToScreen=!0,B.addPass(R),B.addPass(O);var L=new v.lLk;L.onProgress=function(){var t=(0,i.Z)((0,n.Z)().mark((function t(e,r,i){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}();var j=new g._;j.setDecoderPath("libs/draco/"),j.setDecoderConfig({type:"js"});var z=new b.E(L);z.setDRACOLoader(j);var N=null;z.load(r(4e3),(function(t){t.scene&&(t.scene.scale.set(.02,.02,.02),t.scene.position.x=-.5,t.scene.rotation.y=Math.PI,t.scene.layers.set(0),o.add(t.scene),N=t.scene)}));var H=new v.SUY;!function t(r){!function(t){F.uniforms.time.value=t/5e3,F.uniforms.color5.value=s(v.Pa4,(0,l.Z)(D)),F.uniforms.color4.value=s(v.Pa4,(0,l.Z)(U)),F.uniforms.color3.value=s(v.Pa4,(0,l.Z)(P)),F.uniforms.color2.value=s(v.Pa4,(0,l.Z)(C)),F.uniforms.color1.value=s(v.Pa4,(0,l.Z)(x)),F.uniforms.color0.value=s(v.Pa4,(0,l.Z)(T))}(r),e.clear(),a.layers.set(1),B.render(),e.clearDepth(),a.layers.set(0),e.render(o,a);var n=.5*H.getElapsedTime();N&&(N.rotation.x=.2*Math.cos(n),N.rotation.z=.1*Math.sin(n),N.position.z+=.005*Math.cos(n));var i=2*Math.cos(n)+3;E&&E.scale.set(i,i,i),u&&u.update(),p.w&&p.w.update(),window.requestAnimationFrame(t)}()},t}return(0,c.Z)(o,[{key:"componentDidMount",value:function(){this.initThree()}},{key:"componentWillUnmount",value:function(){this.setState=function(){}}},{key:"render",value:function(){return(0,U.jsxs)("div",{className:"rick_and_morty_page",children:[(0,U.jsx)("canvas",{className:"webgl"}),(0,U.jsx)("i",{className:"logo"}),(0,U.jsxs)("a",{className:"github",href:"https://github.com/dragonir/3d",target:"_blank",rel:"noreferrer",children:[(0,U.jsx)("svg",{height:"36","aria-hidden":"true",viewBox:"0 0 16 16",version:"1.1",width:"36","data-view-component":"true",children:(0,U.jsx)("path",{fill:"#FFFFFF",fillRule:"evenodd",d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"})}),(0,U.jsx)("span",{className:"author",children:"@dragonir"})]})]})}}]),o}(f.Component)},5902:function(t){t.exports="#define NUM_OCTAVES 5\n#define M_PI 3.1415926535897932384626433832795\nuniform vec4 resolution;\nvarying vec3 vNormal;\nuniform sampler2D perlinnoise;\nuniform sampler2D sparknoise;\nuniform sampler2D waterturbulence;\nuniform sampler2D noiseTex;\nuniform float time;\nuniform vec3 color0;\nuniform vec3 color1;\nuniform vec3 color2;\nuniform vec3 color3;\nuniform vec3 color4;\nuniform vec3 color5;\nvarying vec3 camPos;\nvarying vec2 vUv;\n\nfloat rand(vec2 n) {\n  return fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\n}\n\nfloat noise(vec2 p){\n  vec2 ip = floor(p);\n  vec2 u = fract(p);\n  u = u*u*(3.0-2.0*u);\n\n  float res = mix(\n    mix(rand(ip),rand(ip+vec2(1.0,0.0)),u.x),\n    mix(rand(ip+vec2(0.0,1.0)),rand(ip+vec2(1.0,1.0)),u.x),u.y);\n  return res*res;\n}\n\nfloat fbm(vec2 x) {\n  float v = 0.0;\n  float a = 0.5;\n  vec2 shift = vec2(100);\n  // \u65cb\u8f6c\u4ee5\u51cf\u5c11\u8f74\u5411\u504f\u7f6e\n  mat2 rot = mat2(cos(0.5), sin(0.5), -sin(0.5), cos(0.50));\n  for (int i = 0; i < NUM_OCTAVES; ++i) {\n    v += a * noise(x);\n    x = rot * x * 2.0 + shift;\n    a *= 0.5;\n  }\n  return v;\n}\n\n  float setOpacity(float r, float g, float b, float tonethreshold) {\n  float tone = (r + g + b) / 3.0;\n  float alpha = 1.0;\n  if(tone<tonethreshold) {\n    alpha = 0.0;\n  }\n  return alpha;\n}\n\nvec3 rgbcol(vec3 col) {\n  return vec3(col.r/255.0,col.g/255.0,col.b/255.0);\n}\n\nvec2 rotate(vec2 v, float a) {\n  float s = sin(a);\n  float c = cos(a);\n  mat2 m = mat2(c, -s, s, c);\n  return m * v;\n}\n\nvec2 UnityPolarCoordinates (vec2 UV, vec2 Center, float RadialScale, float LengthScale){\n  vec2 delta = UV - Center;\n  float radius = length(delta) * 2. * RadialScale;\n  float angle = atan(delta.x, delta.y) * 1.0/6.28 * LengthScale;\n  return vec2(radius, angle);\n}\n\nvoid main() {\n  vec2 olduv = gl_FragCoord.xy/resolution.xy ;\n  vec2 uv = vUv ;\n  vec2 imguv = uv;\n  float scale = 1.;\n  olduv *= 0.5 + time;\n  olduv.y = olduv.y ;\n  vec2 p = olduv*scale;\n  float noise = fbm( p  )*0.04;\n  vec4 txt = texture2D(perlinnoise, olduv);\n  float gradient = dot(normalize( -camPos ), normalize( vNormal ));\n  float pct = distance(vUv,vec2(0.5));\n\n  vec3 rgbcolor0 = rgbcol(color0);\n  vec3 rgbcolor1 = rgbcol(color1);\n  vec3 rgbcolor2 = rgbcol(color2);\n  vec3 rgbcolor3 = rgbcol(color3);\n  vec3 rgbcolor4 = rgbcol(color4);\n  vec3 rgbcolor5 = rgbcol(color5);\n\n  // \u8bbe\u7f6e\u7eaf\u8272\u80cc\u666f\n  float y = smoothstep(0.16,0.525,pct);\n  vec3 backcolor = mix(rgbcolor0, rgbcolor5, y);\n\n  gl_FragColor = vec4(backcolor,1.);\n\n  // \u8bbe\u7f6e\u6781\u5750\u6807\n  vec2 center = vec2(0.5);\n  vec2 cor = UnityPolarCoordinates(vUv, center, 1., 1.);\n  vec2 newvUv = vUv - 0.5;\n  vec3 noisetexvUv = texture2D(perlinnoise,mod(rotate(newvUv*0.15 + vec2(sin(time*0.005),cos(time*0.005)),time),1.)).rgb;\n\n  // \u8bbe\u7f6e\u7eb9\u7406\n  vec2 newUv = vec2(cor.x + time,cor.x+cor.y);\n  vec3 noisetex = texture2D(perlinnoise,mod(newUv,1.)).rgb;\n  vec3 noisetex2 = texture2D(sparknoise,mod(newUv,1.)).rgb;\n  vec3 noisetex3 = texture2D(waterturbulence,mod(newUv,1.)).rgb;\n\n  // \u8bbe\u7f6e\u7eb9\u7406\u8272\u8c03\n  float tone0 =  1. - smoothstep(0.3,0.6,noisetex.r);\n  float tone1 =  smoothstep(0.3,0.6,noisetex2.r);\n  float tone2 =  smoothstep(0.3,0.6,noisetex3.r);\n\n  // \u8bbe\u7f6e\u6bcf\u4e2a\u8272\u8c03\u7684\u4e0d\u900f\u660e\u5ea6\n  float opacity0 = setOpacity(tone0,tone0,tone0,.29);\n  float opacity1 = setOpacity(tone1,tone1,tone1,.49);\n  float opacity2 = setOpacity(tone2,tone2,tone2,.69);\n\n  // \u5efa\u7acb\u5706\u5f62\u566a\u58f0\n  float gradienttone = 1. - smoothstep(0.196,0.532,pct);\n  vec4 circularnoise = vec4( vec3(gradienttone)*noisetexvUv*1.4, 1.0 );\n  float gradopacity = setOpacity(circularnoise.r,circularnoise.g,circularnoise.b,0.19);\n\n  // \u8bbe\u7f6e\u8fb9\u7f18\u9759\u6001\u95ea\u5149\n  vec2 uv2 = uv;\n  float iTime = time*0.004;\n  uv.y += iTime / 10.0;\n  uv.x -= (sin(iTime/10.0)/2.0);\n  uv2.x += iTime / 14.0;\n  uv2.x += (sin(iTime/10.0)/9.0);\n  float result = 0.0;\n  result += texture2D(noiseTex, mod(uv*0.5,1.) * 0.6 + vec2(iTime*-0.003)).r;\n  result *= texture2D(noiseTex, mod(uv2*0.5,1.) * 0.9 + vec2(iTime*+0.002)).b;\n  result = pow(result, 4.0);\n\n  // \u8bbe\u7f6e\u6700\u7ec8\u6e32\u67d3\n  if(opacity2>0.0){\n    gl_FragColor = vec4(rgbcolor4,0.)*vec4(opacity2);\n  } else if(opacity1>0.0){\n    gl_FragColor = vec4(rgbcolor2,0.)*vec4(opacity1);\n  } else if(opacity0>0.0){\n    gl_FragColor = vec4(rgbcolor1,0.)*vec4(opacity0);\n  }\n  gl_FragColor += vec4(108.0)*result*(y*0.02);\n  gl_FragColor *= vec4(gradopacity);\n}"},377:function(t){t.exports="varying vec3 vNormal;\nvarying vec3 camPos;\nvarying vec2 vUv;\n\nvoid main() {\n  vNormal = normal;\n  vUv = uv;\n  camPos = cameraPosition;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}"},4e3:function(t,e,r){"use strict";t.exports=r.p+"static/media/rickAndMorty.7084bfcab48902308e73.glb"},4543:function(t,e,r){"use strict";t.exports=r.p+"static/media/noise.bc66b00a9c9a0cb00284.png"},9340:function(t,e,r){"use strict";t.exports=r.p+"static/media/perlinnoise.b920496e22a2f32c9106.png"},8941:function(t,e,r){"use strict";t.exports=r.p+"static/media/sparknoise.c105ef53f2bf56c926d5.png"},6316:function(t,e,r){"use strict";t.exports=r.p+"static/media/waterturbulence.2e8fc259fc59a9921f6e.png"},2982:function(t,e,r){"use strict";r.d(e,{Z:function(){return o}});var n=r(907);var i=r(181);function o(t){return function(t){if(Array.isArray(t))return(0,n.Z)(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||(0,i.Z)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},6892:function(t,e,r){"use strict";r.d(e,{w:function(){return o}});var n=function(){this._tweens={},this._tweensAddedDuringUpdate={}};n.prototype={getAll:function(){return Object.keys(this._tweens).map(function(t){return this._tweens[t]}.bind(this))},removeAll:function(){this._tweens={}},add:function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},remove:function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},update:function(t,e){var r=Object.keys(this._tweens);if(0===r.length)return!1;for(t=void 0!==t?t:o.now();0<r.length;){this._tweensAddedDuringUpdate={};for(var n=0;n<r.length;n++){var i=this._tweens[r[n]];i&&!1===i.update(t)&&(i._isPlaying=!1,e||delete this._tweens[r[n]])}r=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var i,o=new n;o.Group=n,o._nextId=0,o.nextId=function(){return o._nextId++},"undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?o.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?o.now=self.performance.now.bind(self.performance):void 0!==Date.now?o.now=Date.now:o.now=function(){return(new Date).getTime()},o.Tween=function(t,e){this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=o.Easing.Linear.None,this._interpolationFunction=o.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=e||o,this._id=o.nextId()},o.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},duration:function(t){return this._duration=t,this},start:function(t){for(var e in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==t?"string"==typeof t?o.now()+parseFloat(t):t:o.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}void 0!==this._object[e]&&(this._valuesStart[e]=this._object[e],this._valuesStart[e]instanceof Array==0&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){return this._isPlaying&&(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens()),this},end:function(){return this.update(1/0),this},stopChainedTweens:function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop()},group:function(t){return this._group=t,this},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},repeatDelay:function(t){return this._repeatDelayTime=t,this},yoyo:function(t){return this._yoyo=t,this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var e,r,n;if(t<this._startTime)return!0;for(e in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),r=(t-this._startTime)/this._duration,r=0===this._duration||1<r?1:r,n=this._easingFunction(r),this._valuesEnd)if(void 0!==this._valuesStart[e]){var i=this._valuesStart[e]||0,o=this._valuesEnd[e];o instanceof Array?this._object[e]=this._interpolationFunction(o,n):("string"==typeof o&&(o="+"===o.charAt(0)||"-"===o.charAt(0)?i+parseFloat(o):parseFloat(o)),"number"==typeof o&&(this._object[e]=i+(o-i)*n))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object),1!==r)return!0;if(0<this._repeat){for(e in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if("string"==typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e])),this._yoyo){var a=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=a}this._valuesStart[e]=this._valuesStartRepeat[e]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var s=0,l=this._chainedTweens.length;s<l;s++)this._chainedTweens[s].start(this._startTime+this._duration);return!1}},o.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)}},Bounce:{In:function(t){return 1-o.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*o.Easing.Bounce.In(2*t):.5*o.Easing.Bounce.Out(2*t-1)+.5}}},o.Interpolation={Linear:function(t,e){var r=t.length-1,n=r*e,i=Math.floor(n),a=o.Interpolation.Utils.Linear;return e<0?a(t[0],t[1],n):1<e?a(t[r],t[r-1],r-n):a(t[i],t[r<i+1?r:i+1],n-i)},Bezier:function(t,e){for(var r=0,n=t.length-1,i=Math.pow,a=o.Interpolation.Utils.Bernstein,s=0;s<=n;s++)r+=i(1-e,n-s)*i(e,s)*t[s]*a(n,s);return r},CatmullRom:function(t,e){var r=t.length-1,n=r*e,i=Math.floor(n),a=o.Interpolation.Utils.CatmullRom;return t[0]===t[r]?(e<0&&(i=Math.floor(n=r*(1+e))),a(t[(i-1+r)%r],t[i],t[(i+1)%r],t[(i+2)%r],n-i)):e<0?t[0]-(a(t[0],t[0],t[1],t[1],-n)-t[0]):1<e?t[r]-(a(t[r],t[r],t[r-1],t[r-1],n-r)-t[r]):a(t[i?i-1:0],t[i],t[r<i+1?r:i+1],t[r<i+2?r:i+2],n-i)},Utils:{Linear:function(t,e,r){return(e-t)*r+t},Bernstein:function(t,e){var r=o.Interpolation.Utils.Factorial;return r(t)/r(e)/r(t-e)},Factorial:function(){var t=[1];return function(e){var r=1;if(t[e])return t[e];for(var n=e;1<n;n--)r*=n;return t[e]=r}}(),CatmullRom:function(t,e,r,n,i){var o=.5*(r-t),a=.5*(n-e),s=i*i;return(2*e-2*r+o+a)*(i*s)+(-3*e+3*r-2*o-a)*s+o*i+e}}},i=void 0,"function"==typeof define&&define.amd?define([],(function(){return o})):"undefined"!=typeof module&&"object"==typeof exports?module.exports=o:void 0!==i&&(i.TWEEN=o)},4849:function(t,e,r){"use strict";r.d(e,{_:function(){return u}});var n=r(5671),i=r(3144),o=r(136),a=r(9388),s=r(3562),l=new WeakMap,u=function(t){(0,o.Z)(r,t);var e=(0,a.Z)(r);function r(t){var i;return(0,n.Z)(this,r),(i=e.call(this,t)).decoderPath="",i.decoderConfig={},i.decoderBinary=null,i.decoderPending=null,i.workerLimit=4,i.workerPool=[],i.workerNextTaskID=1,i.workerSourceURL="",i.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},i.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"},i}return(0,i.Z)(r,[{key:"setDecoderPath",value:function(t){return this.decoderPath=t,this}},{key:"setDecoderConfig",value:function(t){return this.decoderConfig=t,this}},{key:"setWorkerLimit",value:function(t){return this.workerLimit=t,this}},{key:"load",value:function(t,e,r,n){var i=this,o=new s.hH6(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(t){var r={attributeIDs:i.defaultAttributeIDs,attributeTypes:i.defaultAttributeTypes,useUniqueIDs:!1};i.decodeGeometry(t,r).then(e).catch(n)}),r,n)}},{key:"decodeDracoFile",value:function(t,e,r,n){var i={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(t,i).then(e)}},{key:"decodeGeometry",value:function(t,e){var r=this;for(var n in e.attributeTypes){var i=e.attributeTypes[n];void 0!==i.BYTES_PER_ELEMENT&&(e.attributeTypes[n]=i.name)}var o,a=JSON.stringify(e);if(l.has(t)){var s=l.get(t);if(s.key===a)return s.promise;if(0===t.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var u=this.workerNextTaskID++,c=t.byteLength,h=this._getWorker(u,c).then((function(r){return o=r,new Promise((function(r,n){o._callbacks[u]={resolve:r,reject:n},o.postMessage({type:"decode",id:u,taskConfig:e,buffer:t},[t])}))})).then((function(t){return r._createGeometry(t.geometry)}));return h.catch((function(){return!0})).then((function(){o&&u&&r._releaseTask(o,u)})),l.set(t,{key:a,promise:h}),h}},{key:"_createGeometry",value:function(t){var e=new s.u9r;t.index&&e.setIndex(new s.TlE(t.index.array,1));for(var r=0;r<t.attributes.length;r++){var n=t.attributes[r],i=n.name,o=n.array,a=n.itemSize;e.setAttribute(i,new s.TlE(o,a))}return e}},{key:"_loadLibrary",value:function(t,e){var r=new s.hH6(this.manager);return r.setPath(this.decoderPath),r.setResponseType(e),r.setWithCredentials(this.withCredentials),new Promise((function(e,n){r.load(t,e,void 0,n)}))}},{key:"preload",value:function(){return this._initDecoder(),this}},{key:"_initDecoder",value:function(){var t=this;if(this.decoderPending)return this.decoderPending;var e="object"!==typeof WebAssembly||"js"===this.decoderConfig.type,r=[];return e?r.push(this._loadLibrary("draco_decoder.js","text")):(r.push(this._loadLibrary("draco_wasm_wrapper.js","text")),r.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(r).then((function(r){var n=r[0];e||(t.decoderConfig.wasmBinary=r[1]);var i=c.toString(),o=["/* draco decoder */",n,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");t.workerSourceURL=URL.createObjectURL(new Blob([o]))})),this.decoderPending}},{key:"_getWorker",value:function(t,e){var r=this;return this._initDecoder().then((function(){if(r.workerPool.length<r.workerLimit){var n=new Worker(r.workerSourceURL);n._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:r.decoderConfig}),n.onmessage=function(t){var e=t.data;switch(e.type){case"decode":n._callbacks[e.id].resolve(e);break;case"error":n._callbacks[e.id].reject(e);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+e.type+'"')}},r.workerPool.push(n)}else r.workerPool.sort((function(t,e){return t._taskLoad>e._taskLoad?-1:1}));var i=r.workerPool[r.workerPool.length-1];return i._taskCosts[t]=e,i._taskLoad+=e,i}))}},{key:"_releaseTask",value:function(t,e){t._taskLoad-=t._taskCosts[e],delete t._callbacks[e],delete t._taskCosts[e]}},{key:"debug",value:function(){console.log("Task load: ",this.workerPool.map((function(t){return t._taskLoad})))}},{key:"dispose",value:function(){for(var t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this}}]),r}(s.aNw);function c(){var t,e;function r(t,e,r,n,i,o){var a=o.num_components(),s=r.num_points()*a,l=s*i.BYTES_PER_ELEMENT,u=function(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32}}(t,i),c=t._malloc(l);e.GetAttributeDataArrayForAllPoints(r,o,u,l,c);var h=new i(t.HEAPF32.buffer,c,s).slice();return t._free(c),{name:n,array:h,itemSize:a}}onmessage=function(n){var i=n.data;switch(i.type){case"init":t=i.decoderConfig,e=new Promise((function(e){t.onModuleLoaded=function(t){e({draco:t})},DracoDecoderModule(t)}));break;case"decode":var o=i.buffer,a=i.taskConfig;e.then((function(t){var e=t.draco,n=new e.Decoder,s=new e.DecoderBuffer;s.Init(new Int8Array(o),o.byteLength);try{var l=function(t,e,n,i){var o,a,s=i.attributeIDs,l=i.attributeTypes,u=e.GetEncodedGeometryType(n);if(u===t.TRIANGULAR_MESH)o=new t.Mesh,a=e.DecodeBufferToMesh(n,o);else{if(u!==t.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");o=new t.PointCloud,a=e.DecodeBufferToPointCloud(n,o)}if(!a.ok()||0===o.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+a.error_msg());var c={index:null,attributes:[]};for(var h in s){var d=self[l[h]],f=void 0,v=void 0;if(i.useUniqueIDs)v=s[h],f=e.GetAttributeByUniqueId(o,v);else{if(-1===(v=e.GetAttributeId(o,t[s[h]])))continue;f=e.GetAttribute(o,v)}c.attributes.push(r(t,e,o,h,d,f))}u===t.TRIANGULAR_MESH&&(c.index=function(t,e,r){var n=3*r.num_faces(),i=4*n,o=t._malloc(i);e.GetTrianglesUInt32Array(r,i,o);var a=new Uint32Array(t.HEAPF32.buffer,o,n).slice();return t._free(o),{array:a,itemSize:1}}(t,e,o));return t.destroy(o),c}(e,n,s,a),u=l.attributes.map((function(t){return t.array.buffer}));l.index&&u.push(l.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:l},u)}catch(c){console.error(c),self.postMessage({type:"error",id:i.id,error:c.message})}finally{e.destroy(s),e.destroy(n)}}))}}}}}]);